import { oceanicNext } from '@code-surfer/themes';
import { CodeSurfer, CodeSurferColumns, Step } from 'code-surfer';
import { themes } from 'mdx-deck';

import { COLUMN_THEMES } from './constants';
import Head from './components/Head';

import './styles/overrides.css';
import './styles/styles.css';

export const theme = themes.notes;

<Head title="React Working Patterns" />

<!-- Slides Start -->

# React Working Patterns

#### UI Meetup - 15th Mar 2021

###### By Phani Rahul Sivalenka [@rahulsivalenka](https://twitter.com/rahulsivalenka)

---

### State Transitions and Keeping Them DRY

---

<CodeSurfer theme={oceanicNext}>

```jsx subtitle="consider this edit form" file=./samples/MyEditForm.txt

```

```jsx 17:27 subtitle="it has two confirmation dialogs" file=./samples/MyEditForm.txt

```

```jsx 14:15 subtitle="which are opened by these two buttons" file=./samples/MyEditForm.txt

```

```jsx 2:8 subtitle="to open and close each of these we require these state and function declarations" file=./samples/MyEditForm.txt

```

```jsx subtitle="how can we refactor this to make it DRY?" file=./samples/MyEditForm.txt

```

```jsx title="#1 Custom Hook" subtitle="one way is to extract repetitive code into a generic custom hook" file=./samples/MyEditForm-alt1.txt

```

```jsx 12,16:17 title="#1 Custom Hook" subtitle="returning an array allows for easier naming of output variables when using multiple times" file=./samples/MyEditForm-alt1.txt

```

</CodeSurfer>

---

<CodeSurferColumns>

<Step title="#1 Custom Hook">

<div className="basic-text-slide">

## Advantages

1. Clean
2. DRY
3. Reusable

## Resources

- [Building Your Own Hooks](https://reactjs.org/docs/hooks-custom.html)
- [useHooks - Easy to understand React Hook recipes](https://usehooks.com/)

</div>

</Step>

</CodeSurferColumns>

---

<CodeSurfer theme={oceanicNext}>

```jsx title="#2 State Machine" subtitle="another way is to use state machine pattern" file=./samples/MyEditForm-alt2.txt

```

```jsx 1:18 title="#2 State Machine" subtitle="define various states and transitions in an object format" file=./samples/MyEditForm-alt2.txt

```

```jsx 20:22,25 title="#2 State Machine" subtitle="define a reducer which performs the state transitions as per the state machine defined" file=./samples/MyEditForm-alt2.txt

```

```jsx 25[29:32],27,33[15:66],34[15:68],38,44 title="#2 State Machine" subtitle="trigger the corresponding event to change the state" file=./samples/MyEditForm-alt2.txt

```

```jsx 39,45 title="#2 State Machine" subtitle="use the state to determine which dialog to show" file=./samples/MyEditForm-alt2.txt

```

</CodeSurfer>

---

##### Visualizing the state machine

<iframe
  height="100%"
  width="90%"
  src="https://xstate.js.org/viz/?gist=f4019c6d8c84f86de8e1fc4fd1883dec"
/>

---

##### Another Use Case: Stepper Transitions

<iframe
  height="100%"
  width="90%"
  src="https://xstate.js.org/viz/?gist=7d8c7c185ee2d08f4ce53c015798567a"
/>

---

<CodeSurferColumns themes={COLUMN_THEMES}>

<Step title="#2 State Machine">

```jsx 1:22 file=./samples/MyEditForm-alt2.txt

```

<div className="basic-text-slide">

### Advantages

1. Clean
2. Predictable
3. Single place to view/change all the states and transitions

### Resources

- [Robust React User Interfaces with Finite State Machines](https://css-tricks.com/robust-react-user-interfaces-with-finite-state-machines/)
- [Finite State Machines with React](https://css-tricks.com/finite-state-machines-with-react/)

</div>

</Step>

</CodeSurferColumns>

---

### Too Many State Declarations

---

<CodeSurfer theme={oceanicNext}>

```jsx subtitle="consider this code sample" file=./samples/TooManyStates.txt

```

```jsx subtitle="react re-renders the component on every state change" file=./samples/TooManyStates.txt

```

```jsx 9:12 subtitle="which means when this useEffect is executed it will render 4 times, once per each state change" file=./samples/TooManyStates.txt

```

```jsx title="#3 useReducer" subtitle="use useReducer hook when there are too many / complex states" file=./samples/TooManyStates-alt.txt

```

</CodeSurfer>
